<div class="main-container admin-page d-flex mt-5">
  <div class="container">
    <div class="row">
      <div class="col-md-2">
        <ul class="list-group mt-4 admin-tabs">
          <li
            class="list-group-item"
            [class.active]="activeTab === 'users'"
            (click)="activeTab = 'users'"
          >
            👤 Usuarios
          </li>
          <li
            class="list-group-item"
            [class.active]="activeTab === 'diets'"
            (click)="activeTab = 'diets'"
          >
            🥗 Dietas
          </li>
          <li
            class="list-group-item"
            [class.active]="activeTab === 'workouts'"
            (click)="activeTab = 'workouts'"
          >
            🏋️ Rutinas
          </li>
        </ul>
      </div>
      <div class="col-md-10 mt-4">
        <ng-container *ngIf="activeTab === 'users'">
          <div class="container mt-4">
            <h3>Gestión de Usuarios</h3>
            <!-- Filter Controls -->
            <div class="d-flex mb-3">
              <select
                [(ngModel)]="gymGoalFilter"
                (change)="filterUsers()"
                class="form-select me-2"
              >
                <option value="">Filtrar por Objetivo</option>
                <option *ngFor="let goal of gymGoals" [value]="goal">
                  {{ goal | gymGoalLabel }}
                </option>
              </select>

              <select
                [(ngModel)]="subscriptionFilter"
                (change)="filterUsers()"
                class="form-select me-2"
              >
                <option value="">Filtrar por Suscripción</option>
                <option *ngFor="let sub of subscriptions" [value]="sub">
                  {{ sub }}
                </option>
              </select>

              <button class="btn btn-secondary w-25" (click)="resetFilters()">
                Reset
              </button>
            </div>
            <table class="table table-striped mt-3">
              <thead>
                <tr>
                  <th>Email</th>
                  <th>Nombre</th>
                  <th>Apellido</th>
                  <th>Objetivo de Gimnasio</th>
                  <th>Suscripción</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of filteredUsers">
                  <td>{{ user.email }}</td>
                  <td>{{ user.name }}</td>
                  <td>{{ user.surname }}</td>
                  <td>{{ user.gym_goal | gymGoalLabel }}</td>
                  <td>
                    <span *ngIf="user.subscription_name; else noSubscription">
                      {{ user.subscription_name }}
                    </span>
                    <ng-template #noSubscription>Sin suscripción</ng-template>
                  </td>
                  <td>
                    <button
                      class="btn btn-sm btn-primary me-1"
                      (click)="openEditModal(user)"
                    >
                      ✏️
                    </button>
                    <button
                      class="btn btn-sm btn-danger me-1"
                      (click)="deleteUser(user.email)"
                    >
                      🗑️
                    </button>
                    <button
                      class="btn btn-sm btn-success"
                      (click)="openAssignDietModal(user.email)"
                    >
                      🥗
                    </button>
                    <button
                      class="btn btn-sm btn-warning"
                      (click)="openAssignWorkoutModal(user.email)"
                    >
                      🏋️
                    </button>
                    <button
                      class="btn btn-sm btn-info"
                      (click)="viewUserDetails(user.email)"
                      title="Ver detalles"
                    >
                      📄
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          
        
